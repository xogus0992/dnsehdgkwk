<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>My 다이어트 정보 (컬러 최종판)</title>
<style>
    body { font-family: 'Malgun Gothic', dotum, '돋움', sans-serif; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
    .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 90%; max-width: 450px; text-align: center; }
    h2 { margin-top: 0; }
    .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
    input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 1em; box-sizing: border-box; }
    button { width: 100%; padding: 12px; margin-top: 10px; background: #4caf50; color: white; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: background-color 0.2s; }
    button:hover { background-color: #45a049; }
    #character-display { margin: 25px auto; width: 120px; height: 180px; display: flex; justify-content: center; align-items: center; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #eee; }
    
    #characterImage {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        /* ✅ 흑백 필터를 제거하여 컬러로 보이게 수정했습니다. */
    }

    #goal-progress { margin-top: 20px; }
    .progress-bar-container { width: 100%; background-color: #ddd; border-radius: 10px; height: 25px; overflow: hidden; display: flex; }
    #bar-achieved { background-color: #4caf50; height: 100%; transition: width 0.5s ease; }
    #bar-excess { background-color: #e61a5f; height: 100%; transition: width 0.5s ease; }
    #progress-text { font-weight: bold; margin-top: 8px; }
    #result-display { margin-top: 20px; text-align: left; background: #f8f9fa; padding: 15px; border-radius: 8px;}
    #result-display p { margin: 5px 0; font-weight: bold; }
</style>
</head>
<body>

<div class="container">
    <h2>내 몸 정보 입력</h2>
    <div class="input-grid">
        <select id="gender">
            <option value="male">남성</option>
            <option value="female">여성</option>
        </select>
        <input type="number" id="age" placeholder="나이">
        <input type="number" id="height" placeholder="키 (cm)">
        <input type="number" id="weight" placeholder="현재 체중 (kg)">
        <input type="number" id="fat" placeholder="체지방률 (%)">
        <input type="number" id="muscle" placeholder="근육량 (kg)">
    </div>
    <input type="number" id="goalWeight" placeholder="목표 체중 (kg)">
    <button onclick="updateAllInfo()">확인</button>
    <div id="character-display">
        <img id="characterImage" src="" alt="캐릭터">
    </div>
    <div id="goal-progress">
        <div class="progress-bar-container">
            <div id="bar-achieved"></div>
            <div id="bar-excess"></div>
        </div>
        <div id="progress-text">목표를 설정해주세요.</div>
    </div>
    <div id="result-display">
        <p id="bmi-result">BMI: -</p>
        <p id="bmr-result">기초대사량(BMR): -</p>
    </div>
</div>

<script>
    const characterImages = {
        male: {
            lean: 'https://i.imgur.com/91TKFuE.png',
            average: 'https://i.imgur.com/ecc7NYi.png',
            overweight: 'https://i.imgur.com/QJZsUvT.png',
            obese: 'https://i.imgur.com/qGxG0QR.png'
        },
        female: {
            lean: 'https://i.imgur.com/2bsZnpy.png',
            average: 'https://i.imgur.com/FhsJnOM.png',
            overweight: 'https://i.imgur.com/4QUIyGg.png',
            obese: 'https://i.imgur.com/abQJ2Me.png'
        }
    };

    function updateAllInfo() {
        const gender = document.getElementById("gender").value;
        const age = parseFloat(document.getElementById("age").value);
        const height = parseFloat(document.getElementById("height").value);
        const weight = parseFloat(document.getElementById("weight").value);
        const fat = parseFloat(document.getElementById("fat").value);
        const goalWeight = parseFloat(document.getElementById("goalWeight").value);

        if (height && weight) {
            const bmi = weight / ((height / 100) ** 2);
            let bmiStatus = "";
            if (bmi < 18.5) { bmiStatus = "저체중"; }
            else if (bmi < 25) { bmiStatus = "정상"; }
            else if (bmi < 30) { bmiStatus = "과체중"; }
            else { bmiStatus = "비만"; }
            document.getElementById("bmi-result").innerText = `BMI: ${bmi.toFixed(1)} (${bmiStatus})`;

            if (!isNaN(fat)) {
                let bodyTypeKey = 'average';
                if (gender === 'male') {
                    if (fat < 14) { bodyTypeKey = 'lean'; }
                    else if (fat < 18) { bodyTypeKey = 'average'; }
                    else if (fat < 25) { bodyTypeKey = 'overweight'; }
                    else { bodyTypeKey = 'obese'; }
                } else { // female
                    if (fat < 21) { bodyTypeKey = 'lean'; }
                    else if (fat < 25) { bodyTypeKey = 'average'; }
                    else if (fat < 31) { bodyTypeKey = 'overweight'; }
                    else { bodyTypeKey = 'obese'; }
                }
                document.getElementById("characterImage").src = characterImages[gender][bodyTypeKey];
                document.getElementById("characterImage").style.display = 'block';
            }

            if (age) {
                let bmr = (gender === 'male')
                    ? 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age)
                    : 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
                document.getElementById("bmr-result").innerText = `기초대사량(BMR): 약 ${Math.round(bmr)} kcal`;
            } else {
                document.getElementById("bmr-result").innerText = '기초대사량(BMR): 나이를 입력하세요.';
            }
        }

        const barAchieved = document.getElementById("bar-achieved");
        const barExcess = document.getElementById("bar-excess");
        const progressText = document.getElementById("progress-text");
        barAchieved.style.width = '0%';
        barExcess.style.width = '0%';
        
        if (weight && goalWeight) {
            if (weight > goalWeight) {
                const diff = weight - goalWeight;
                const achievedPercent = (goalWeight / weight) * 100;
                const excessPercent = 100 - achievedPercent;
                
                barAchieved.style.width = `${achievedPercent}%`;
                barExcess.style.width = `${excessPercent}%`;
                progressText.innerText = `목표까지 ${diff.toFixed(1)} kg 감량이 필요합니다!`;

            } else {
                const diff = goalWeight - weight;
                const achievedPercent = (weight / goalWeight) * 100;
                barAchieved.style.width = `${achievedPercent}%`;
                
                if (diff > 0) {
                    progressText.innerText = `목표까지 ${diff.toFixed(1)} kg 증량이 필요합니다!`;
                } else {
                    progressText.innerText = "🎉 목표 체중 달성! 축하합니다!";
                }
            }
        } else {
            progressText.innerText = "목표 체중을 입력해주세요.";
        }
    }
    
    window.onload = () => {
        document.getElementById("characterImage").style.display = 'none';
    };
</script>

</body>
</html>